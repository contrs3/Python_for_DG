from sqlalchemy import create_engine, text
import pandas as pd


ic_batch_list = ['31931969-001', '31959887-001', '31967130-001', '31968703-001', '31959955-001', '31967132-001', '31959888-001', '31959980-001', '31967477-001', '31967479-001', '31967521-001', '31968769-001', '31968789-001', '31968790-001', '31967136-001', '31967523-001', '31968704-001', '31968705-001', '31967135-001', '31980636-001', '31980638-001', '31981520-001', '31981535-001', '31980780-001', '31980843-001', '31981525-001', '31981527-001', '31981532-001', '31980633-001', '31980639-001', '31980844-001', '31981523-001', '31981526-001', '31980634-001', '31980635-001', '31980637-001', '31980782-001', '31980783-001', '31980840-001', '31980842-001', '31981529-001', '31981534-001', '31981531-001', '31989492-001', '31989493-001', '31989494-001', '31990246-001', '31990249-001', '31989483-001', '31989484-001', '31989491-001', '31990247-001', '31990251-001', '31990253-001', '31989485-001', '31989486-001', '31990248-001', '31990250-001', '31990414-001', '31989487-001', '31989488-001', '31989495-001', '31989496-001', '31990252-001', '31990409-001', '31990410-001', '31990411-001', '31990412-001', '31997863-001', '31997866-001', '31997867-001', '31997906-001', '31999620-001', '31989497-001', '31989499-001', '31990413-001', '31997819-001', '31997904-001', '31999458-001', '31999459-001', '31999623-001', '31999624-001', '31997738-001', '31997739-001', '31997844-001', '31997861-001', '31997862-001', '31997901-001', '32001096-001', '32006832-001', '31967131-001', '31967133-001', '31980801-001', '31980857-001', '31997902-001', '32006594-001', '31967134-001', '31980802-001', '31980846-001', '31980848-001', '31980856-001', '31980858-001', '31997900-001', '32005542-001', '32006592-001', '32008460-001', '31997908-001', '31997910-001', '32005540-001', '32005541-001', '32005543-001', '32005545-001', '32005546-001', '32008339-001', '31997843-001', '31997860-001', '31997911-001', '32005119-001', '32005544-001', '32006593-001', '32006851-001', '32006852-001', '32008337-001', '32008338-001', '32008461-001', '32017478-001', '32017479-001', '32017604-001', '32017731-001', '32017738-001', '32006830-001', '32006857-001', '32006858-001', '32017729-001', '32017730-001', '32017734-001', '32017736-001', '32017726-001', '32017733-001', '32017476-001', '32017477-001', '32017722-001', '32017727-001', '32017728-001', '32019387-001', '32006853-001', '32006854-001', '32006855-001', '32006856-001', '32017720-001', '32017732-001', '32017760-001', '32019382-001', '32008501-001', '32008502-001', '32017723-001', '32017761-001', '32019386-001', '32019388-001', '32029145-001', '32029147-001', '32029148-001', '32029149-001', '32030234-001', '32008503-001', '32017725-001', '32030240-001', '32030248-001', '32033678-001', '32008504-001', '32008505-001', '32008506-001', '32030114-001', '32030115-001', '32030116-001', '32030118-001', '32030133-001', '32030147-001', '32030164-001', '32030168-001', '32008507-001', '32029146-001', '32030119-001', '32030134-001', '32030135-001', '32030136-001', '32030149-001', '32030165-001', '32030166-001', '32017724-001', '32030137-001', '32030151-001', '32030160-001', '32033399-001', '32033740-001', '32030117-001', '32030161-001', '32030162-001', '32030163-001', '32030167-001', '32030169-001', '32030241-001', '32030242-001', '32030244-001', '32030246-001', '32030250-001', '32033673-001', '32033674-001', '32033677-001', '32042370-001', '32042377-001', '32030252-001', '32033676-001', '32042373-001', '32042375-001', '32030247-001', '32030254-001', '32042376-001', '32042378-001', '32030243-001', '32033675-001', '32048569-001', '32048570-001', '32048634-001', '32030245-001', '32040610-001', '32041234-001', '32041236-001', '32042371-001', '32042374-001', '32041235-001', '32042430-001', '32048074-001', '32048563-001', '32048565-001', '32048630-001', '32048631-001', '32042428-001', '32042431-001', '32048632-001', '32048633-001', '32048636-001', '32030249-001', '32042372-001', '32042426-001', '32048637-001', '32048075-001', '32048076-001', '32048641-001', '32048643-001', '32058628-001', '32058636-001', '32058638-001', '32058860-001', '32058864-001', '32048078-001', '32048079-001', '32058634-001', '32058861-001', '32048073-001', '32048567-001', '32058630-001', '32058632-001', '32058862-001', '32058863-001', '32058625-001', '32058865-001', '32064601-001', '32066294-001', '32066297-001', '32066486-001', '32048568-001', '32048640-001', '32048642-001', '32048644-001', '32058846-001', '32064600-001', '32066558-001', '32048645-001', '32066295-001', '32066556-001', '32064216-001', '32064603-001', '32066296-001', '32066540-001', '32066550-001', '32066555-001', '32048571-001', '32048646-001', '32064217-001', '32064219-001', '32066484-001', '32066541-001', '32066548-001', '32066549-001', '32064215-001', '32064242-001', '32064445-001', '32066299-001', '32066494-001', '32066495-001', '32066298-001', '32066483-001', '32066485-001', '32066526-001', '32066546-001', '32083589-001', '32083590-001', '32083591-001', '32066547-001', '32066554-001', '32083580-001', '32083581-001', '32083588-001', '32083593-001', '32083594-001', '32066544-001', '32066545-001', '32066559-001', '32083558-001', '32083582-001', '32083583-001', '32083595-001', '32083596-001', '32066543-001', '32083584-001', '32083586-001', '32083587-001', '32083597-001', '32083599-001', '32090601-001', '32090604-001', '32090615-001', '32090957-001', '32090959-001', '32090606-001', '32090618-001', '32090640-001', '32090954-001', '32090956-001', '32090958-001', '32066542-001', '32090524-001', '32090526-001', '32090953-001', '32091624-001', '32091628-001', '32091629-001', '32091630-001', '32094131-001', '32094133-001', '32090457-001', '32090522-001', '32090951-001', '32090952-001', '32091620-001', '32091625-001', '32091626-001', '32091640-001', '32094137-001', '32090955-001', '32091621-001', '32091623-001', '32099450-001', '32099453-001', '32099471-001', '32099489-001', '32091622-001', '32095358-001', '32099443-001', '32099447-001', '32099462-001', '32099275-001', '32099276-001', '32099442-001', '32099465-001', '32099468-001', '32099487-001', '32099495-001', '32102179-001', '32099278-001', '32099493-001', '32099494-001', '32102320-001', '32102322-001', '32102323-001', '32099444-001', '32099445-001', '32099486-001', '32099491-001', '32099460-001', '32099492-001', '32099446-001', '32099485-001', '32099488-001', '32102176-001', '32102178-001', '32102321-001', '32109870-001', '32099038-001', '32099441-001', '32099037-001', '32099279-001', '32099496-001', '32109871-001', '32109873-001', '32099472-001', '32099473-001', '32102175-001', '32102177-001', '32107709-001', '32107710-001', '32107711-001', '32109784-001', '32109872-001', '32099449-001', '32099470-001', '32107708-001', '32107712-001', '32109785-001', '32109786-001', '32109860-001', '32109869-001', '32109578-001', '32109579-001', '32119855-001', '32119976-001', '32120262-001', '32119856-001', '32120260-001', '32120261-001', '32120268-001', '32122263-001', '32109575-001', '32109577-001', '32119854-001', '32119857-001', '32119858-001', '32119859-001', '32119973-001', '32120014-001', '32120016-001', '32120263-001', '32120264-001', '32120265-001', '32120266-001', '32120270-001', '32122264-001', '32122387-001', '32119974-001', '32120017-001', '32107844-001', '32119975-001', '32129956-001', '32129957-001', '32129958-001', '32129960-001', '32129953-001', '32129959-001', '32120502-001', '32129507-001', '32129919-001', '32129940-001', '32129951-001', '32122265-001', '32122266-001', '32129477-001', '32129508-001', '32129509-001', '32129941-001', '32129954-001', '32129955-001', '32122388-001', '32122389-001', '32122390-001', '32129474-001', '32129476-001', '32129773-001', '32129774-001', '32129946-001', '32129947-001', '32139730-001', '32139731-001', '32141301-001', '32129475-001', '32129479-001', '32129775-001', '32129913-001', '32129915-001', '32129942-001', '32129945-001', '32129948-001', '32139538-001', '32141088-001', '32141089-001', '32141091-001', '32129943-001', '32139527-001', '32139529-001', '32139531-001', '32141087-001', '32141300-001', '32141303-001', '32129730-001', '32129944-001', '32139535-001', '32139537-001', '32141090-001', '32141093-001', '32147756-001', '32129731-001', '32129777-001', '32129908-001', '32129911-001', '32129914-001', '32139532-001', '32141096-001', '32144328-001', '32144329-001', '32144331-001', '32144336-001', '32147754-001', '32147757-001', '32129732-001', '32129909-001', '32129910-001', '32139534-001', '32139536-001', '32144330-001', '32144332-001', '32144333-001', '32144334-001', '32147759-001', '32129912-001', '32141095-001', '32147755-001', '32147758-001', '32154287-001', '32154288-001', '32154289-001', '32154347-001', '32154354-001', '32154357-001', '32154388-001', '32154389-001', '32156801-001', '32141097-001', '32141098-001', '32141302-001', '32149316-001', '32154156-001', '32154340-001', '32154386-001', '32154391-001', '32156668-001', '32156784-001', '32156800-001', '32156803-001', '32154392-001', '32156539-001', '32154343-001', '32154353-001', '32154393-001', '32154394-001', '32156780-001', '32156802-001', '32154151-001', '32154158-001', '32154342-001', '32154344-001', '32154355-001', '32154395-001', '32156534-001', '32156783-001', '32154153-001', '32154341-001', '32154345-001', '32154356-001', '32154396-001', '32156538-001', '32156781-001', '32156782-001', '32156669-001', '32156671-001', '32163975-001', '32164284-001', '32164302-001', '32167299-001', '32163974-001', '32164189-001', '32164193-001', '32164232-001', '32164305-001', '32167519-001', '32156670-001', '32156672-001', '32163976-001', '32164075-001', '32164233-001', '32167518-001', '32167780-001', '32167781-001', '32164076-001', '32164077-001', '32164192-001', '32164194-001', '32164280-001', '32164281-001', '32167231-001', '32172734-001', '32172735-001', '32164282-001']

conn_string = 'postgresql://Data_Science_User:Data4use@crdwh.cnhh4zmfsfrl.us-east-1.rds.amazonaws.com/crdwh'
db = create_engine(conn_string)
conn = db.connect()
sql_imp = f"""
select * from "EquipmentIntegration"."Impedance_Summary"
WHERE "Batch_Id" in {tuple(ic_batch_list)}
--WHERE "Txn_Date" >= '2023-01-01'
--WHERE "Txn_Date" >= current_date - interval '10' day
"""
imp_df = pd.read_sql_query(text(sql_imp), con=conn)
conn.close()

csv_path = r'C:\Python\impedance.csv'
imp_df.to_csv(csv_path, index=False)

print(f"DataFrame saved as CSV at path: {csv_path}")
